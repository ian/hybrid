# Hybrid CLI

Command-line interface for managing Hybrid XMTP agent projects. The CLI provides essential tools for project development, key management, and XMTP integration.

## Installation

The CLI is included with the `hybrid` package:

```bash
pnpm install hybrid
```

Or use it directly with npx:

```bash
npx hybrid <command>
```

## Commands

### `hybrid dev`

Start development server with watch mode for TypeScript compilation.

```bash
hybrid dev
# or
hy dev
```

This command:
- Compiles TypeScript in watch mode
- Restarts the agent when files change
- Provides real-time development feedback

### `hybrid build`

Build the TypeScript project for production.

```bash
hybrid build
# or
hy build
```

Compiles all TypeScript files to JavaScript in the `dist/` directory.

### `hybrid clean`

Remove the `dist/` directory and clean build artifacts.

```bash
hybrid clean
# or
hy clean
```

### `hybrid keys`

Generate XMTP wallet and encryption keys for your agent.

```bash
hybrid keys
# or
hy keys

# Save keys directly to .env file
hybrid keys --write
# or
hy keys --write
```

This command generates:
- **XMTP_WALLET_KEY**: Private key for XMTP wallet identity
- **XMTP_ENCRYPTION_KEY**: 32-byte hex string for message encryption

Without `--write`, keys are displayed in the terminal. With `--write`, they are automatically saved to your `.env` file.

### `hybrid register`

Register your wallet with the XMTP production network.

```bash
hybrid register
# or
hy register
```

Required before your agent can send/receive messages on the production XMTP network.

### `hybrid revoke <inboxId>`

Revoke XMTP installations for a specific inbox.

```bash
hybrid revoke <inboxId>
# or
hy revoke <inboxId>
```

Use this to remove specific XMTP client installations when needed.

### `hybrid revoke:all`

Revoke ALL XMTP installations for the current wallet.

```bash
hybrid revoke:all
# or
hy revoke:all
```

**Warning**: This removes all XMTP installations for your wallet. Use with caution.

### `hybrid upgrade`

Upgrade all hybrid and @hybrd/* packages to their latest versions.

```bash
hybrid upgrade
# or
hy up
```

Automatically updates:
- `hybrid` package
- All `@hybrd/*` scoped packages
- Maintains compatibility across the ecosystem

## Environment Requirements

The CLI requires Node.js version 20 or higher. If you're using an older version, you'll see an error message prompting you to upgrade.

## Configuration

### Environment Variables

The CLI uses these environment variables:

```env
# Required for XMTP functionality
XMTP_WALLET_KEY=0x...        # Generated by `hybrid keys`
XMTP_ENCRYPTION_KEY=...      # Generated by `hybrid keys`
XMTP_ENV=dev                 # or "production"

# Optional
PORT=8454                    # Development server port
```

### Project Structure

The CLI expects your project to follow this structure:

```
my-agent/
├── src/
│   └── agent.ts            # Main agent implementation
├── dist/                   # Built JavaScript (created by build)
├── .env                    # Environment variables
├── package.json
└── tsconfig.json
```

## Development Workflow

1. **Create a new project**:
   ```bash
   npx create-hybrid my-agent
   cd my-agent
   ```

2. **Generate XMTP keys**:
   ```bash
   hybrid keys --write
   ```

3. **Start development**:
   ```bash
   hybrid dev
   ```

4. **Build for production**:
   ```bash
   hybrid build
   ```

5. **Register with XMTP** (for production):
   ```bash
   hybrid register
   ```

## Troubleshooting

### Node.js Version Error

If you see "Node.js version 20 or higher is required":
- Update Node.js to version 20+
- Use a version manager like nvm: `nvm install 20 && nvm use 20`

### XMTP Connection Issues

If XMTP commands fail:
- Ensure `XMTP_WALLET_KEY` is set in your environment
- Check that your wallet is registered: `hybrid register`
- Verify the `XMTP_ENV` setting matches your target network

### Build Failures

If `hybrid build` fails:
- Check TypeScript configuration in `tsconfig.json`
- Ensure all dependencies are installed: `pnpm install`
- Run `hybrid clean` and try building again

## Related Packages

- [`hybrid`](../core) - Main agent framework
- [`create-hybrid`](../create-hybrid) - Project scaffolding tool
- [`@hybrd/xmtp`](../xmtp) - XMTP client integration
- [`@hybrd/utils`](../utils) - Utility functions

## License

MIT

